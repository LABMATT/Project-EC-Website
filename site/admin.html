<!DOCTYPE html>
<html>
    <head>
        <title>Admin</title>
        <link rel="stylesheet" type="text/css" href="/HGC-ECH/HGC-ECH/site/styles.css">
    </head>
    <style>
    
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}
th, td {
  padding: 15px;
  text-align: left;
}
th {
    background-color: purple;
    color: white;
    font-weight: bold;
    font-family: Arial, Helvetica, sans-serif;
}
    </style>
<body onload="init()"> 
<script src="/HGC-ECH/HGC-ECH/site/socket.io/dist/socket.io.js"></script>
<script>var socket = io("127.0.0.1:3000");</script>

    <h1 id="greet"></h1>
    <p>This is how your current class is looking!</p>
    
    <div>
        <table id="table" style="width:100%">
            <tr>
              <th>Group Name</th>
              <th>Password</th>
              <th>Project DIR</th>
              <th>Project View</th>
              <th>Admin</th>
              <th>Delete</th>
              <th>Select</th>
            </tr>
          </table>
    </div>

</body>
</html>

<script>
    function init()
    {
        var cid = document.cookie.substr((document.cookie.indexOf("id=") + 3), document.cookie.length).split(';')[0];
        console.log(cid);
        socket.emit("rego", cid);
        socket.emit("info", ["name", cid]);
        grabTable();
    }

    function grabTable()
    {
        socket.emit("admin", "update");
    }

    // Check the recived user name
    socket.on('username', function(msg){
    document.getElementById("greet").innerHTML = "Welcome back admin " + msg;
    });

    // get the recived rows and build new table.
    socket.on('update', function(msg){
        console.log("updating table");
        console.log(msg);

    var table = document.getElementById("table");

    msg.forEach(element => {
    var row = table.insertRow(1);
    var un = row.insertCell(0);
    var pw = row.insertCell(1);
    var dir = row.insertCell(2);
    var pv = row.insertCell(3);
    var ad = row.insertCell(4);
    var del = row.insertCell(5);
    var sel = row.insertCell(6);

    un.innerHTML = element.username;
    pw.innerHTML = element.password;
    dir.innerHTML = element.projectdir;
    pv.innerHTML = "null";

    if(element.admin == 1)
    {
        ad.innerHTML = "true";
    }else{
        ad.innerHTML = "false";
    }

    del.innerHTML = "null";
    sel.innerHTML = "<input type='checkbox' id='vehicle1' >";
    
    });
    });
</script>